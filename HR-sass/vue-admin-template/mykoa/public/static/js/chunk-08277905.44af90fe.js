(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08277905"],{"0ccb":function(e,t,n){var r=n("50c4"),a=n("1148"),o=n("1d80"),i=Math.ceil,s=function(e){return function(t,n,s){var c,u,d=String(o(t)),l=d.length,p=void 0===s?" ":String(s),f=r(n);return f<=l||""==p?d:(c=f-l,u=a.call(p,i(c/p.length)),u.length>c&&(u=u.slice(0,c)),e?d+u:u+d)}};e.exports={start:s(!1),end:s(!0)}},"1eef":function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s}));var r=n("b775");function a(){return Object(r["a"])({url:"/company/department"})}function o(e){return Object(r["a"])({url:"/company/department/".concat(e),method:"DELETE"})}function i(e){return Object(r["a"])({url:"/company/department",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/company/department/".concat(e.id),method:"put",data:e})}},"4d90":function(e,t,n){"use strict";var r=n("23e7"),a=n("0ccb").start,o=n("9a0c");r({target:"String",proto:!0,forced:o},{padStart:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},"6c7f":function(e,t,n){},"8f00":function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"k",(function(){return l})),n.d(t,"f",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"b",(function(){return m}));var r=n("b775");function a(){return Object(r["a"])({url:"/sys/user/simple"})}function o(e){return Object(r["a"])({url:"/sys/user",params:e})}function i(e){return Object(r["a"])({url:"/sys/user/".concat(e),method:"delete"})}function s(e){return Object(r["a"])({url:"/sys/user/",method:"post",data:e})}function c(e){return Object(r["a"])({url:"/sys/user/batch",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/sys/user/".concat(e.id),method:"put",data:e})}function d(e){return Object(r["a"])({url:"/employees/".concat(e,"/personalInfo")})}function l(e){return Object(r["a"])({url:"/employees/".concat(e.userId,"/personalInfo"),method:"put",data:e})}function p(e){return Object(r["a"])({url:"/employees/".concat(e,"/jobs")})}function f(e){return Object(r["a"])({url:"/employees/".concat(e.userId,"/jobs"),method:"put",data:e})}function m(e){return Object(r["a"])({url:"/sys/user/assignRoles",data:e,method:"put"})}},"9a0c":function(e,t,n){var r=n("342f");e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r)},c4f2:function(e,t,n){"use strict";n("6c7f")},ed08:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n("53ca"),n("ac1f"),n("00b4"),n("5319"),n("4d63"),n("2c3e"),n("25f0"),n("d3b7"),n("4d90"),n("159b");function r(e,t){var n=[];return e&&e.forEach((function(a){if(a.pid===t){n.push(a);var o=r(e,a.id);o.length&&(a.children=o)}})),n}},fb3b:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"departments-container"},[n("div",{staticClass:"app-container"},[n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"tree-card"},[n("tree-tools",{attrs:{"tree-node":e.company,"is-root":!0},on:{openDialog:e.openDialog}}),n("el-tree",{attrs:{data:e.departs,props:e.defaultProps,"default-expand-all":!0},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.data;return n("tree-tools",{attrs:{"tree-node":r},on:{openDialog:e.openDialog,update:e.getDepartments}})}}])})],1)],1),e.showDialog?n("addDialog",{ref:"openDialog",attrs:{node:e.node,"dia-log-type":e.diaLogType,departs:e.list},on:{update:e.getDepartments},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}}):e._e()],1)},a=[],o=n("c7eb"),i=n("1da1"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"edit"===e.diaLogType?"编辑":"新增",visible:e.value,"before-close":e.handleClose},on:{"update:visible":function(t){e.value=t}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}]},[n("el-form",{ref:"ruleForm",attrs:{model:e.form,"label-width":"120px",rules:e.rules}},[n("el-form-item",{attrs:{label:"部门名称",prop:"name"}},[n("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"部门编码",prop:"code"}},[n("el-input",{model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),n("el-form-item",{attrs:{label:"部门负责人",prop:"manager"}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.manager,callback:function(t){e.$set(e.form,"manager",t)},expression:"form.manager"}},e._l(e.peoples,(function(e){return n("el-option",{key:e.id,attrs:{label:e.username,value:e.username}})})),1)],1),n("el-form-item",{attrs:{label:"部门介绍",prop:"introduce"}},[n("el-input",{attrs:{type:"textarea",rows:3},model:{value:e.form.introduce,callback:function(t){e.$set(e.form,"introduce",t)},expression:"form.introduce"}})],1),n("el-form-item")],1),n("el-row",{attrs:{type:"flex",justify:"center"}},[n("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取消")]),n("el-button",{attrs:{type:"primary",size:"small",loading:e.submitLoading},on:{click:e.handleSubmit}},[e._v("确定")])],1)],1)])},c=[],u=n("5530"),d=(n("d3b7"),n("4de4"),n("b0c0"),n("8f00")),l=n("1eef"),p={props:{departs:{type:Array},diaLogType:{type:String,default:"add"},value:{type:Boolean,default:!1},node:{type:Object}},data:function(){var e=this,t=function(){var t=Object(i["a"])(Object(o["a"])().mark((function t(n,r,a){var i;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:i="add"===e.diaLogType?e.departs.filter((function(t){return t.pid===e.node.id})).some((function(e){return e.name===r})):e.departs.filter((function(t){return t.pid==e.node.pid&&t.id!=e.node.id})).some((function(e){return e.name===r})),i?a(new Error("同级部门已经存在".concat(r,"这个部门了"))):a();case 2:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),n=function(){var t=Object(i["a"])(Object(o["a"])().mark((function t(n,r,a){var i;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:i="add"===e.diaLogType?e.departs.some((function(e){return e.code===r&&r})):e.departs.some((function(t){return t.code===r&&r!==e.node.code})),i?a(new Error("已经存在".concat(r,"这个编码了"))):a();case 2:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}();return{submitLoading:!1,isLoading:!0,form:{},rules:{name:[{required:!0,message:"请输入部门名称",trigger:"blur"},{min:1,max:50,message:"长度在1-50个字符之间",trigger:"blur"},{validator:t,trigger:"blur"}],code:[{required:!0,message:"请输入部门编码",trigger:"change"},{min:1,max:50,message:"部门编码在1-50个字符之间",trigger:"blur"},{validator:n,trigger:"blur"}],manager:[{required:!0,message:"请输入部门负责人",trigger:"blur"}],introduce:[{required:!0,message:"请输入部门介绍",trigger:"blur"},{min:1,max:300,message:"部门介绍在1-300个字符之间",trigger:"blur"}]},peoples:[]}},created:function(){this.getEmployeeSimple(),"edit"===this.diaLogType&&(this.form=this.node)},methods:{getEmployeeSimple:function(){var e=this;return Object(i["a"])(Object(o["a"])().mark((function t(){var n,r;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(d["e"])();case 3:n=t.sent,r=n.data,e.peoples=r,e.isLoading=!1,t.next=12;break;case 9:return t.prev=9,t.t0=t["catch"](0),t.abrupt("return");case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},handleSubmit:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;"add"===e.diaLogType?e.addInfo():e.editInfo()}))},editInfo:function(){var e=this;return Object(i["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l["d"])(e.form);case 3:t.sent,e.$message({message:"更新成功",type:"success"}),e.$emit("update"),e.$emit("input",!1),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),t.t0.response&&405===t.t0.response.status&&e.$message({message:"系统默认数据不可修改",type:"error"});case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},addInfo:function(){var e=this;return Object(i["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.submitLoading=!0,t.prev=1,t.next=4,Object(l["a"])(Object(u["a"])(Object(u["a"])({},e.form),{},{pid:e.node.id}));case 4:e.$message({message:"添加成功",type:"success"}),e.$emit("update"),e.$emit("input",!1);case 7:return t.prev=7,e.submitLoading=!1,t.finish(7);case 10:case"end":return t.stop()}}),t,null,[[1,,7,10]])})))()},handleClose:function(){this.$emit("input",!1)}}},f=p,m=n("2877"),b=Object(m["a"])(f,s,c,!1,null,"96107c62",null),g=b.exports,h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{staticStyle:{height:"40px",width:"100%"},attrs:{type:"flex",justify:"space-between",align:"middle"}},[n("el-col",[n("span",[e._v(e._s(e.treeNode.name))])]),n("el-col",{attrs:{span:4}},[n("el-row",{attrs:{type:"flex"}},[n("el-col",[e._v(e._s(e.treeNode.manager))]),n("el-col",[n("el-dropdown",[n("span",[e._v(" 操作"),n("i",{staticClass:"el-icon-arrow-down"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"add"},nativeOn:{click:function(t){return e.$emit("openDialog","add",e.treeNode)}}},[e._v("添加子部门")]),e.isRoot?e._e():n("el-dropdown-item",{attrs:{command:"edit"},nativeOn:{click:function(t){return e.$emit("openDialog","edit",e.treeNode)}}},[e._v("编辑部门")]),e.isRoot?e._e():n("el-dropdown-item",{attrs:{command:"delete"},nativeOn:{click:function(t){return e.confirmDelete(t)}}},[e._v("删除部门")])],1)],1)],1)],1)],1)],1)},v=[],j={props:{node:{},treeNode:{required:!0,type:[Object]},isRoot:{type:Boolean,default:!1}},methods:{confirmDelete:function(){var e=this;this.$confirm("您确定要删除".concat(this.treeNode.name,"?"),{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){e.deleteDepartments()})).catch((function(){}))},deleteDepartments:function(){var e=this;return Object(i["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l["b"])(e.treeNode.id);case 3:e.$message({message:"删除成功",type:"success"}),e.$emit("update"),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),t.t0.response&&405===t.t0.response.status&&e.$message({message:"系统默认数据不可删除，只可删除默认数据",type:"error"});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()}}},w=j,y=Object(m["a"])(w,h,v,!1,null,"057b9f8a",null),O=y.exports,x=n("ed08"),k={name:"Departments",components:{addDialog:g,TreeTools:O},data:function(){return{isLoading:!0,diaLogType:"add",node:{},showDialog:!1,company:{name:"农业种植有限公司",manager:"负责人",id:""},departs:[],list:[],defaultProps:{label:"name"}}},created:function(){this.getDepartments()},methods:{openDialog:function(e,t){this.diaLogType=e,this.node=t,this.showDialog=!0},getDepartments:function(){var e=this;return Object(i["a"])(Object(o["a"])().mark((function t(){var n,r;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["c"])();case 2:n=t.sent,r=n.data.depts,e.list=r,e.departs=Object(x["a"])(r,""),e.isLoading=!1;case 7:case"end":return t.stop()}}),t)})))()}}},D=k,L=(n("c4f2"),Object(m["a"])(D,r,a,!1,null,"70f24dfd",null));t["default"]=L.exports}}]);