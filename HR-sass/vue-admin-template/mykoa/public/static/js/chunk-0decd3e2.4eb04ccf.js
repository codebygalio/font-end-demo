(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0decd3e2"],{"01f5":function(e,t,a){"use strict";t["a"]={hireType:[{id:1,value:"正式"},{id:2,value:"非正式"}],subjection:[{id:"1",value:"总部"},{id:"2",value:"分城市"}],workingState:[{id:"1",value:"在职"},{id:"2",value:"离职"}],leaveType:[{id:"1",value:"主动离职"},{id:"2",value:"被动离职"},{id:"3",value:"退休"}],attritionMonth:[{id:"1",value:"离职日本月"},{id:"2",value:"离职日次月"}],informaltype:[{id:"2",value:"实习"},{id:"3",value:"劳务"},{id:"4",value:"顾问"},{id:"5",value:"返聘"},{id:"6",value:"外包"}],highestDegree:[{id:"1",value:"初中"},{id:"2",value:"高中"},{id:"3",value:"中专"},{id:"4",value:"大专"},{id:"5",value:"本科"},{id:"6",value:"硕士"},{id:"7",value:"博士"},{id:"8",value:"其他"}],isOverseas:[{id:"1",value:"中国大陆"},{id:"2",value:"港澳台国外"}],gender:[{id:"1",value:"男"},{id:"2",value:"女"}],maritaStatus:[{id:"1",value:"未婚"},{id:"2",value:"已婚"},{id:"3",value:"离异"}],animalSymbol:[{id:"1",value:"鼠"},{id:"2",value:"牛"},{id:"3",value:"虎"},{id:"4",value:"兔"},{id:"5",value:"龙"},{id:"6",value:"蛇"},{id:"7",value:"马"},{id:"8",value:"羊"},{id:"9",value:"猴"},{id:"10",value:"鸡"},{id:"11",value:"狗"},{id:"12",value:"猪"}],constellation:[{code:1,value:"水瓶座"},{code:2,value:"双鱼座"},{code:3,value:"白羊座"},{code:4,value:"金牛座"},{code:5,value:"双子座"},{code:6,value:"巨蟹座"},{code:7,value:"狮子座"},{code:8,value:"处女座"},{code:9,value:"天秤座"},{code:10,value:"天蝎座"},{code:11,value:"射手座"},{code:12,value:"摩羯座"}],bloodType:[{id:"1",value:"A型"},{id:"2",value:"B型"},{id:"3",value:"O型"},{id:"4",value:"AB型"}],educationType:[{id:"1",value:"统招"},{id:"2",value:"自考"},{id:"3",value:"成考"}],positiveType:[{id:"1",value:"已转正"},{id:"2",value:"未转正"}],contractPeriod:[{id:"1",value:"6月"},{id:"2",value:"12月"},{id:"3",value:"24月"},{id:"4",value:"36月"},{id:"5",value:"其他"}],renewalCount:[{id:1,value:"0次"},{id:2,value:"1次"},{id:3,value:"2次"},{id:4,value:"3次"},{id:5,value:"4次或以上"}],resumeSource:[{id:"1",value:"智联招聘"},{id:"2",value:"拉勾网"},{id:"3",value:"前程无忧"},{id:"4",value:"猎聘网"},{id:"5",value:"校园宣讲"},{id:"6",value:"猎头"},{id:"7",value:"内部推荐"}],hireSourceType:[{id:"1",value:"社招"},{id:"2",value:"校招"}],departments:[{id:"1",value:"总裁办"},{id:"2",value:"研究院"}],stausInfos:[{id:"1",value:"在职"},{id:"2",value:"入职"},{id:"3",value:"离职"}]}},"0b62":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"employees-container app-container"},[r("page-tools",{scopedSlots:e._u([{key:"after",fn:function(){return[r("el-button",{attrs:{size:"small",type:"success"},on:{click:function(t){return e.$router.push("/import")}}},[e._v("excel导入")]),r("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.exportData}},[e._v("excel导出")]),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.showDialog=!0}}},[e._v("新增员工")])]},proxy:!0}])},[r("span",{attrs:{slot:"before"},slot:"before"},[e._v("共"+e._s(e.page.total)+"条记录")])]),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.employeeList,border:!0}},[r("el-table-column",{attrs:{type:"index",label:"序号",sortable:""}}),r("el-table-column",{attrs:{label:"姓名",prop:"username",sortable:""}}),r("el-table-column",{attrs:{label:"头像",prop:"staffPhoto",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[r("img",{directives:[{name:"imageError",rawName:"v-imageError",value:a("bae5"),expression:"require('@/assets/common/bigUserHeader.png')"}],staticStyle:{width:"100px","border-radius":"50%",height:"100px",padding:"10px"},attrs:{src:n.staffPhoto},on:{click:function(t){return e.showQRCode(n)}}})]}}])}),r("el-table-column",{attrs:{label:"手机号",prop:"mobile",sortable:""}}),r("el-table-column",{attrs:{label:"工号",prop:"workNumber",sortable:""}}),r("el-table-column",{attrs:{label:"聘用形式",prop:"formOfEmployment",formatter:e.formOfEmployment,sortable:""}}),r("el-table-column",{attrs:{label:"部门",prop:"departmentName",sortable:""}}),r("el-table-column",{attrs:{label:"入职时间",prop:"timeOfEntry",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e._f("formatDate")(a.timeOfEntry))+" ")]}}])}),r("el-table-column",{attrs:{label:"账户状态",prop:"enableState",sortable:""},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[r("el-switch",{attrs:{value:1===+t.enableState}})]}}])}),r("el-table-column",{attrs:{label:"操作",fixed:"right",width:"280",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.$router.push("/employees/detail/"+a.id)}}},[e._v("查看")]),r("el-button",{attrs:{type:"text",size:"small"}},[e._v("转正")]),r("el-button",{attrs:{type:"text",size:"small"}},[e._v("调岗")]),r("el-button",{attrs:{type:"text",size:"small"}},[e._v("离职")]),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.assignRole(a.id)}}},[e._v("角色")]),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirmDelEmpoyee(a)}}},[e._v("删除")])]}}])})],1),r("el-row",{staticStyle:{height:"60px"},attrs:{type:"flex",justify:"end",align:"center"}},[r("el-pagination",{attrs:{"current-page":e.page.page,"page-size":e.page.size,layout:"total, prev, pager, next",total:e.page.total},on:{"current-change":e.handleCurrentChange}})],1),e.showDialog?r("openDialog",{on:{update:e.getEmployeeList},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}}):e._e(),r("el-dialog",{attrs:{title:"二维码",visible:e.codeDialog},on:{"update:visible":function(t){e.codeDialog=t}}},[r("el-row",{attrs:{type:"flex",justify:"center"}},[r("canvas",{ref:"myCanvas"})])],1),r("assignRole",{ref:"assignRoleDialog",attrs:{userId:e.userId},model:{value:e.assignRoleDialog,callback:function(t){e.assignRoleDialog=t},expression:"assignRoleDialog"}})],1)},n=[],o=a("c7eb"),l=a("1da1"),i=(a("d3b7"),a("3ca3"),a("ddb0"),a("b64b"),a("d81d"),a("7db0"),a("8f00")),s=a("01f5"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"新增员工",visible:e.value,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.value=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.showLoading,expression:"showLoading"}]},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"姓名",prop:"username"}},[a("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),a("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[a("el-input",{attrs:{placeholder:"请输入手机号",type:"tel",maxlength:"11"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),a("el-form-item",{attrs:{label:"入职时间",prop:"timeOfEntry"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"请输入入职时间"},model:{value:e.form.timeOfEntry,callback:function(t){e.$set(e.form,"timeOfEntry",t)},expression:"form.timeOfEntry"}})],1),a("el-form-item",{attrs:{label:"聘用形式",prop:"formOfEmployment"}},[a("el-select",{attrs:{placeholder:"请选择聘用形式"},model:{value:e.form.formOfEmployment,callback:function(t){e.$set(e.form,"formOfEmployment",t)},expression:"form.formOfEmployment"}},e._l(e.employees.hireType,(function(e){return a("el-option",{key:e.id,attrs:{label:e.value,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"工号",prop:"workNumber"}},[a("el-input",{attrs:{placeholder:"请输入工号"},model:{value:e.form.workNumber,callback:function(t){e.$set(e.form,"workNumber",t)},expression:"form.workNumber"}})],1),a("el-form-item",{attrs:{label:"部门",prop:"departmentName"}},[a("el-input",{attrs:{placeholder:"请输入部门"},on:{focus:function(t){e.showDepartList=!0}},model:{value:e.form.departmentName,callback:function(t){e.$set(e.form,"departmentName",t)},expression:"form.departmentName"}}),a("el-tree",{directives:[{name:"show",rawName:"v-show",value:e.showDepartList,expression:"showDepartList"}],attrs:{data:e.departList,props:{label:"name"},"default-expand-all":""},on:{"node-click":e.handleNodeClick}})],1),a("el-form-item",{attrs:{label:"转正时间",prop:"correctionTIme"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"转正时间"},model:{value:e.form.correctionTIme,callback:function(t){e.$set(e.form,"correctionTIme",t)},expression:"form.correctionTIme"}})],1)],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-row",{attrs:{type:"flex",align:"middle",justify:"center"}},[a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"small",loading:e.buttonLoading},on:{click:e.submitForm}},[e._v("确定")])],1)],1)],1)])},c=[],d=(a("b0c0"),a("1eef")),m=a("ed08"),p={props:{value:{type:Boolean}},data:function(){return{employees:s["a"],buttonLoading:!1,departList:[],showDepartList:!1,showLoading:!1,form:{departmentName:""},rules:{username:[{required:!0,message:"姓名不能为空",trigger:"blur"},{min:1,max:10,message:"长度在 2 到 4 个字符",trigger:"blur"}],mobile:[{required:!0,message:"手机号不能为空",trigger:"blur"},{pattern:/^1[3-9][0-9]{9}$/,message:"手机号格式错误",trigger:"blur"}],timeOfEntry:[{required:!0,message:"入职时间不能为空",trigger:"blur"}],formOfEmployment:[{required:!0,message:"聘用形式不能为空",trigger:"blur"}],workNumber:[{required:!0,message:"工号不能为空",trigger:"blur"}],departmentName:[{required:!0,message:"部门不能为空",trigger:"change"}],correctionTIme:[{required:!0,message:"转正时间不能为空",trigger:"blur"}]}}},created:function(){this.getDepartments()},methods:{handleClose:function(){this.$emit("input",!1)},getDepartments:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){var a,r;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.showLoading=!0,t.prev=1,t.next=4,Object(d["c"])();case 4:a=t.sent,r=a.data.depts,e.departList=Object(m["a"])(r,""),e.showLoading=!1;case 8:return t.prev=8,t.abrupt("return");case 11:case"end":return t.stop()}}),t,null,[[1,,8,11]])})))()},handleNodeClick:function(e){this.form.departmentName=e.name,this.showDepartList=!1},submitForm:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs.form.validate();case 3:return e.buttonLoading=!0,t.next=6,Object(i["a"])(e.form);case 6:a=t.sent,e.$message({message:a.message,type:"success"}),e.$emit("update"),e.handleClose(),e.$parent.getEmployeeList(),t.next=16;break;case 13:return t.prev=13,t.t0=t["catch"](0),t.abrupt("return",!1);case 16:return t.prev=16,e.buttonLoading=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,13,16,19]])})))()}}},f=p,v=a("2877"),b=Object(v["a"])(f,u,c,!1,null,"3b83951a",null),g=b.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"分配角色",visible:e.value,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.value=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}]},[a("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},e._l(e.roles,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1),a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{slot:"footer",type:"flex",justify:"center"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.assignRoles}},[e._v("确 定")]),a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取 消")])],1)],1)])},y=[],w=a("90e7"),O=a("c24f"),x={props:{value:{type:Boolean},userId:{}},data:function(){return{isLoading:!1,checkList:[],roles:[]}},watch:{value:function(e){0==this.checkList&&0==e&&this.getRoleList()}},created:function(){this.getRoleList()},methods:{assignRoles:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(i["b"])({id:e.userId,roleIds:e.checkList});case 3:a=t.sent,e.$message({type:a.success?"success":"error",message:a.message}),a.success&&e.handleClose();case 6:return t.prev=6,t.abrupt("return");case 9:case"end":return t.stop()}}),t,null,[[0,,6,9]])})))()},handleClose:function(){this.$emit("input",!1)},getRoleList:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){var a,r;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.prev=1,t.next=4,Object(w["f"])({page:1,pagesize:20});case 4:a=t.sent,r=a.data.rows,e.roles=r;case 7:return t.prev=7,t.abrupt("return");case 10:case"end":return t.stop()}}),t,null,[[1,,7,10]])})))()},getUserDetailById:function(e){var t=this;return Object(l["a"])(Object(o["a"])().mark((function a(){var r,n;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.isLoading=!0,a.prev=1,a.next=4,Object(O["b"])(e);case 4:r=a.sent,n=r.data,t.checkList=n.roleIds,t.roles.length>0&&(t.isLoading=!1);case 8:return a.prev=8,a.finish(8);case 10:case"end":return a.stop()}}),a,null,[[1,,8,10]])})))()}}},j=x,k=Object(v["a"])(j,h,y,!1,null,"47689f51",null),L=k.exports,E=a("8975"),D=a("d055"),_=a.n(D),$={name:"Employees",components:{openDialog:g,assignRole:L},data:function(){return{userId:null,assignRoleDialog:!1,codeDialog:!1,showDialog:!1,tableLoading:!0,employeeList:[],page:{page:1,size:20,total:0}}},created:function(){this.getEmployeeList()},methods:{showQRCode:function(e){var t=this;this.codeDialog=!0,this.$nextTick((function(){_.a.toCanvas(t.$refs.myCanvas,e.username)}))},exportData:function(){var e=this,t={"姓名":"username","手机号":"mobile","入职时间":"timeOfEntry","聘用形式":"formOfEmployment","转正时间":"correctionTime","工号":"workNumber","部门":"departmentName"};Promise.all([a.e("chunk-519483dc"),a.e("chunk-78cc0e16")]).then(a.bind(null,"2206")).then(function(){var a=Object(l["a"])(Object(o["a"])().mark((function a(r){var n,l,s,u,c;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(i["d"])({page:1,size:e.page.total});case 2:n=a.sent,l=n.data.rows,s=[["姓名","主要信息","","","","","工号"]],u=["A1:A2","B1:F1","G1:G2"],c=e.formatJson(t,l),r.export_json_to_excel({header:Object.keys(t),data:c,multiHeader:s,merges:u});case 9:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())},formatJson:function(e,t){return t.map((function(t){return Object.keys(e).map((function(a){if("timeOfEntry"===e[a]||"correctionTime"===e[a])return Object(E["formatDate"])(t[e[a]]);if("formOfEmployment"===e[a]){var r=s["a"].hireType.find((function(r){return r.id==t[e[a]]}));return r?r.value:"未知"}return t[e[a]]}))}))},getEmployeeList:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){var a,r;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.prev=1,t.next=4,Object(i["d"])(e.page);case 4:a=t.sent,r=a.data,e.employeeList=r.rows,e.tableLoading=!1,e.page.total=r.total;case 9:return t.prev=9,t.abrupt("return");case 12:case"end":return t.stop()}}),t,null,[[1,,9,12]])})))()},handleCurrentChange:function(e){this.page.page=e,this.getEmployeeList()},formOfEmployment:function(e,t,a,r){var n=s["a"].hireType.find((function(e){return e.id==a}));return n?n.value:"未知"},confirmDelEmpoyee:function(e){var t=this;this.$confirm("此操作将永久删除 ".concat(e.username," , 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.delEmpoyee(e.id)})).catch((function(){}))},delEmpoyee:function(e){var t=this;return Object(l["a"])(Object(o["a"])().mark((function a(){var r;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(i["c"])(e);case 3:r=a.sent,t.$message({type:r.success?"success":"error",message:r.message}),r.success&&t.getEmployeeList();case 6:return a.prev=6,a.abrupt("return");case 9:case"end":return a.stop()}}),a,null,[[0,,6,9]])})))()},assignRole:function(e){this.userId=e,this.$refs.assignRoleDialog.getUserDetailById(e),this.assignRoleDialog=!0}}},N=$,T=Object(v["a"])(N,r,n,!1,null,"3b9576b7",null);t["default"]=T.exports},"1eef":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return i}));var r=a("b775");function n(){return Object(r["a"])({url:"/company/department"})}function o(e){return Object(r["a"])({url:"/company/department/".concat(e),method:"DELETE"})}function l(e){return Object(r["a"])({url:"/company/department",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/company/department/".concat(e.id),method:"put",data:e})}},"8f00":function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return i})),a.d(t,"h",(function(){return s})),a.d(t,"i",(function(){return u})),a.d(t,"g",(function(){return c})),a.d(t,"k",(function(){return d})),a.d(t,"f",(function(){return m})),a.d(t,"j",(function(){return p})),a.d(t,"b",(function(){return f}));var r=a("b775");function n(){return Object(r["a"])({url:"/sys/user/simple"})}function o(e){return Object(r["a"])({url:"/sys/user",params:e})}function l(e){return Object(r["a"])({url:"/sys/user/".concat(e),method:"delete"})}function i(e){return Object(r["a"])({url:"/sys/user/",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/sys/user/batch",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/sys/user/".concat(e.id),method:"put",data:e})}function c(e){return Object(r["a"])({url:"/employees/".concat(e,"/personalInfo")})}function d(e){return Object(r["a"])({url:"/employees/".concat(e.userId,"/personalInfo"),method:"put",data:e})}function m(e){return Object(r["a"])({url:"/employees/".concat(e,"/jobs")})}function p(e){return Object(r["a"])({url:"/employees/".concat(e.userId,"/jobs"),method:"put",data:e})}function f(e){return Object(r["a"])({url:"/sys/user/assignRoles",data:e,method:"put"})}},"90e7":function(e,t,a){"use strict";a.d(t,"f",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return u}));var r=a("b775");function n(e){return Object(r["a"])({url:"/sys/role",params:e})}function o(e){return Object(r["a"])({url:"/sys/role/".concat(e),method:"DELETE"})}function l(e){return Object(r["a"])({url:"/sys/role/".concat(e)})}function i(e){return Object(r["a"])({url:"/sys/role/".concat(e.id),method:"PUT",data:e})}function s(e){return Object(r["a"])({url:"/sys/role",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/sys/role/assignPrem",method:"put",data:e})}},ed08:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("53ca"),a("ac1f"),a("00b4"),a("5319"),a("4d63"),a("2c3e"),a("25f0"),a("d3b7"),a("4d90"),a("159b");function r(e,t){var a=[];return e&&e.forEach((function(n){if(n.pid===t){a.push(n);var o=r(e,n.id);o.length&&(n.children=o)}})),a}}}]);